

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qrl.env.core.compiler module &mdash; qrl-qai 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            qrl-qai
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">BASICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/bloch_sphere.html">BlochSphereV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/probability.html">ProbabilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/error_channel.html">ErrorChannelV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/expressibility.html">ExpressibilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/compiler.html">CompilerV0</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ENVIRONMENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base_env.html">Base Enviornment Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="blochsphere.html">BlochSphereV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiler.html">CompilerV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="errorchannel.html">ErrorChannelV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressibility.html">ExpressibilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability.html">ProbabilityV0</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AGENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="agents.html">Agents</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qrl-qai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">qrl.env.core.compiler module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/qrl.env.core.compiler.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-qrl.env.core.compiler">
<span id="qrl-env-core-compiler-module"></span><h1>qrl.env.core.compiler module<a class="headerlink" href="#module-qrl.env.core.compiler" title="Link to this heading"></a></h1>
<p>Implementation of CompilerV0 environment
Author: Jay Shah (&#64;Jayshah25)
License: Apache-2.0</p>
<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.compiler.CompilerV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.compiler.</span></span><span class="sig-name descname"><span class="pre">CompilerV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.compiler.CompilerV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Single-qubit quantum gate compilation environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">CompilerV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment that models the
problem of compiling a target single-qubit unitary using a fixed, discrete
gate set. The agent incrementally applies quantum gates to build a circuit
whose resulting unitary approximates a given target operation in SU(2).</p>
<p>At each step, the agent selects a gate action that left-multiplies the current
circuit unitary. The episode reward is based on the average gate fidelity
between the current unitary and the target unitary, encouraging the agent to
discover short, high-fidelity gate sequences.</p>
<section id="key-properties">
<h2>Key properties<a class="headerlink" href="#key-properties" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Action space</strong>: Discrete set of single-qubit gates (Clifford + rotations).</p></li>
<li><p><strong>Observation space</strong>: Flattened real and imaginary parts of the current
<code class="docutils literal notranslate"><span class="pre">2×2</span></code> unitary (shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>).</p></li>
<li><p><strong>Reward</strong>: Average gate fidelity with respect to the target unitary.</p></li>
<li><p><strong>Termination</strong>: Success when fidelity exceeds <code class="docutils literal notranslate"><span class="pre">reward_tolerance</span></code> or
truncation at <code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p></li>
</ul>
</section>
<section id="rendering">
<h2>Rendering<a class="headerlink" href="#rendering" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method visualizes the compilation process by displaying a
heatmap of the magnitude of the difference matrix <code class="docutils literal notranslate"><span class="pre">|U_target</span> <span class="pre">−</span> <span class="pre">U|</span></code> over time,
annotated with the current step, last applied gate, and reward.</p>
</section>
<section id="input-parameters">
<h2>Input Parameters<a class="headerlink" href="#input-parameters" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>target<span class="classifier">np.ndarray</span></dt><dd><p>Target <code class="docutils literal notranslate"><span class="pre">2×2</span></code> unitary matrix in SU(2) to compile towards.</p>
</dd>
<dt>max_steps<span class="classifier">int</span></dt><dd><p>Maximum number of gate applications per episode.</p>
</dd>
<dt>reward_tolerance<span class="classifier">float</span></dt><dd><p>Fidelity threshold for early termination.</p>
</dd>
<dt>ffmpeg<span class="classifier">bool</span></dt><dd><p>Whether to use FFmpeg when saving animations.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><span class="xref std std-doc">tutorials/compiler</span></dt><dd><p>Step-by-step tutorial on compiling SU(2) unitaries using <code class="docutils literal notranslate"><span class="pre">CompilerV0</span></code>.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.compiler.CompilerV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.compiler.CompilerV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>Apply a quantum gate action and compute the compilation reward.</p>
<p>This method left-multiplies the current circuit unitary by the unitary
corresponding to the selected action and evaluates the average gate
fidelity with respect to the target unitary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average gate fidelity between the current unitary and the target
unitary, defined as
<code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">|Tr(U_target†</span> <span class="pre">·</span> <span class="pre">U)|</span></code> for a single-qubit system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.compiler.CompilerV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.compiler.CompilerV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the compilation process as an animation of the difference matrix.</p>
<p>The visualization shows the magnitude of the element-wise difference
<code class="docutils literal notranslate"><span class="pre">|U_target</span> <span class="pre">-</span> <span class="pre">U|</span></code> as a heatmap that evolves over time, along with
annotations indicating the current step, applied action, and reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p></li>
<li><p><strong>interval</strong> (<em>int</em><em>, </em><em>optional</em>) – Delay between animation frames in milliseconds. Default is 800.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.compiler.CompilerV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.compiler.CompilerV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to the initial compilation state.</p>
<p>The circuit unitary is reset to the identity matrix, the step counter
is cleared, and the history buffer is reinitialized.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Flattened observation corresponding to the identity unitary,
shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with the Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.compiler.CompilerV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.compiler.CompilerV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one compilation step.</p>
<p>Applies the selected gate, updates the internal circuit unitary and
history, computes the reward, and checks termination conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Updated flattened unitary observation, shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Average gate fidelity after applying the action.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode has terminated due to reaching the fidelity
threshold or the maximum number of steps.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with the Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jay Shah.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
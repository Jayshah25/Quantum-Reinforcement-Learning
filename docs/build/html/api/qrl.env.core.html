

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qrl.env.core package &mdash; qrl-qai 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            qrl-qai
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">BASICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/bloch_sphere.html">BlochSphereV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/probability.html">ProbabilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/error_channel.html">ErrorChannelV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/expressibility.html">ExpressibilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/compiler.html">CompilerV0</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ENVIRONMENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base_env.html">Base Enviornment Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="blochsphere.html">BlochSphereV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiler.html">CompilerV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="errorchannel.html">ErrorChannelV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressibility.html">ExpressibilityV0</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability.html">ProbabilityV0</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AGENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="agents.html">Agents</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qrl-qai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">qrl.env.core package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/qrl.env.core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qrl-env-core-package">
<h1>qrl.env.core package<a class="headerlink" href="#qrl-env-core-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.base__.html">qrl.env.core.base__ module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.base__.html#qrl.env.core.base__.QuantumEnv"><code class="docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.base__.html#qrl.env.core.base__.QuantumEnv.get_reward"><code class="docutils literal notranslate"><span class="pre">QuantumEnv.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.base__.html#qrl.env.core.base__.QuantumEnv.render"><code class="docutils literal notranslate"><span class="pre">QuantumEnv.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.base__.html#qrl.env.core.base__.QuantumEnv.reset"><code class="docutils literal notranslate"><span class="pre">QuantumEnv.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.base__.html#qrl.env.core.base__.QuantumEnv.step"><code class="docutils literal notranslate"><span class="pre">QuantumEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.bloch_sphere.html">qrl.env.core.bloch_sphere module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.bloch_sphere.html#qrl.env.core.bloch_sphere.BlochSphereV0"><code class="docutils literal notranslate"><span class="pre">BlochSphereV0</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.bloch_sphere.html#qrl.env.core.bloch_sphere.BlochSphereV0.get_reward"><code class="docutils literal notranslate"><span class="pre">BlochSphereV0.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.bloch_sphere.html#qrl.env.core.bloch_sphere.BlochSphereV0.render"><code class="docutils literal notranslate"><span class="pre">BlochSphereV0.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.bloch_sphere.html#qrl.env.core.bloch_sphere.BlochSphereV0.reset"><code class="docutils literal notranslate"><span class="pre">BlochSphereV0.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.bloch_sphere.html#qrl.env.core.bloch_sphere.BlochSphereV0.step"><code class="docutils literal notranslate"><span class="pre">BlochSphereV0.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.compiler.html">qrl.env.core.compiler module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.compiler.html#qrl.env.core.compiler.CompilerV0"><code class="docutils literal notranslate"><span class="pre">CompilerV0</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.compiler.html#qrl.env.core.compiler.CompilerV0.get_reward"><code class="docutils literal notranslate"><span class="pre">CompilerV0.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.compiler.html#qrl.env.core.compiler.CompilerV0.render"><code class="docutils literal notranslate"><span class="pre">CompilerV0.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.compiler.html#qrl.env.core.compiler.CompilerV0.reset"><code class="docutils literal notranslate"><span class="pre">CompilerV0.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.compiler.html#qrl.env.core.compiler.CompilerV0.step"><code class="docutils literal notranslate"><span class="pre">CompilerV0.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.error_channel.html">qrl.env.core.error_channel module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.error_channel.html#qrl.env.core.error_channel.ErrorChannelV0"><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.error_channel.html#qrl.env.core.error_channel.ErrorChannelV0.get_reward"><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.error_channel.html#qrl.env.core.error_channel.ErrorChannelV0.render"><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.error_channel.html#qrl.env.core.error_channel.ErrorChannelV0.reset"><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.error_channel.html#qrl.env.core.error_channel.ErrorChannelV0.step"><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.expressibility.html">qrl.env.core.expressibility module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0.action_meanings"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0.action_meanings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0.get_reward"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0.render"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0.reset"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.expressibility.html#qrl.env.core.expressibility.ExpressibilityV0.step"><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.probability.html">qrl.env.core.probability module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.probability.html#qrl.env.core.probability.ProbabilityV0"><code class="docutils literal notranslate"><span class="pre">ProbabilityV0</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.probability.html#qrl.env.core.probability.ProbabilityV0.get_reward"><code class="docutils literal notranslate"><span class="pre">ProbabilityV0.get_reward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.probability.html#qrl.env.core.probability.ProbabilityV0.render"><code class="docutils literal notranslate"><span class="pre">ProbabilityV0.render()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.probability.html#qrl.env.core.probability.ProbabilityV0.reset"><code class="docutils literal notranslate"><span class="pre">ProbabilityV0.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qrl.env.core.probability.html#qrl.env.core.probability.ProbabilityV0.step"><code class="docutils literal notranslate"><span class="pre">ProbabilityV0.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qrl.env.core.utils.html">qrl.env.core.utils module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.utils.html#qrl.env.core.utils.RX"><code class="docutils literal notranslate"><span class="pre">RX()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.utils.html#qrl.env.core.utils.RY"><code class="docutils literal notranslate"><span class="pre">RY()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="qrl.env.core.utils.html#qrl.env.core.utils.RZ"><code class="docutils literal notranslate"><span class="pre">RZ()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-qrl.env.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-qrl.env.core" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.BlochSphereV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.</span></span><span class="sig-name descname"><span class="pre">BlochSphereV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/bloch_sphere.html#BlochSphereV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.BlochSphereV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Single-qubit Bloch sphere environment for reinforcement learning.</p>
<p><code class="docutils literal notranslate"><span class="pre">BlochSphereV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment where an agent
controls a single qubit via a discrete set of quantum gates. The qubit state is
represented internally as a statevector and exposed to the agent as a 3D Bloch
vector <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code>.</p>
<p>The objective is to steer the qubit from the fixed initial state <code class="docutils literal notranslate"><span class="pre">|0⟩</span></code> to a
target pure state (default <code class="docutils literal notranslate"><span class="pre">|+⟩</span></code>) within a limited number of steps by applying
unitary gate actions.</p>
<section id="key-details">
<h3>Key details<a class="headerlink" href="#key-details" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Action space</strong>: Discrete set of single-qubit gates (Clifford + common rotations).</p></li>
<li><p><strong>Observation space</strong>: Bloch vector <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code>, each component in <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>Reward</strong>: Fidelity <code class="docutils literal notranslate"><span class="pre">|⟨target</span> <span class="pre">|</span> <span class="pre">state⟩|²</span></code> in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>Termination</strong>: Success when reward exceeds <code class="docutils literal notranslate"><span class="pre">reward_tolerance</span></code> or truncation</p></li>
</ul>
<p>at <code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p>
</section>
<section id="rendering">
<h3>Rendering<a class="headerlink" href="#rendering" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method visualizes the Bloch sphere and the agent’s trajectory,
showing the current state and target state as arrows in 3D.</p>
</section>
<section id="input-parameters">
<h3>Input Parameters<a class="headerlink" href="#input-parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>target_state</strong>: Target pure state as a Numpy complex 2-vector, defaults to <code class="docutils literal notranslate"><span class="pre">|+⟩</span></code>.</p></li>
<li><p><strong>max_steps</strong>: Maximum number of steps per episode.</p></li>
<li><p><strong>reward_tolerance</strong>: Fidelity threshold for successful termination.</p></li>
<li><p><strong>ffmpeg</strong>: If set to True, animations are saved as mp4 videos, else as GIFs. Default is False.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><span class="xref std std-doc">tutorials/bloch_sphere</span></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.BlochSphereV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/bloch_sphere.html#BlochSphereV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.BlochSphereV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>Apply a quantum gate action and compute the resulting reward.</p>
<p>This method evolves the internal qubit state by applying the unitary
corresponding to the selected action and evaluates the fidelity with
respect to the target state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fidelity between the current state and the target state, defined as
<code class="docutils literal notranslate"><span class="pre">|⟨target</span> <span class="pre">|</span> <span class="pre">state⟩|²</span></code> and bounded in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.BlochSphereV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/bloch_sphere.html#BlochSphereV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.BlochSphereV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the Bloch sphere trajectory as a 3D animation.</p>
<p>The visualization shows:
- A translucent Bloch sphere with labeled basis states,
- The target Bloch vector (green, static),
- The evolving qubit state trajectory (red, dynamic).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p></li>
<li><p><strong>interval</strong> (<em>int</em><em>, </em><em>optional</em>) – Delay between animation frames in milliseconds. Default is 800.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.BlochSphereV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/bloch_sphere.html#BlochSphereV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.BlochSphereV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to the initial state.</p>
<p>The qubit is initialized to the computational basis state <a href="#id1"><span class="problematic" id="id2">|</span></a>0⟩.
Episode step count and history are cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Initial Bloch vector corresponding to <a href="#id3"><span class="problematic" id="id4">|</span></a>0⟩, shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.BlochSphereV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/bloch_sphere.html#BlochSphereV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.BlochSphereV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one environment step.</p>
<p>Applies the selected quantum gate, updates the internal state and history,
computes the reward, and checks termination conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Updated Bloch vector of the qubit state, shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Fidelity-based reward after applying the action.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode has terminated due to success or truncation.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.CompilerV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.</span></span><span class="sig-name descname"><span class="pre">CompilerV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.CompilerV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Single-qubit quantum gate compilation environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">CompilerV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment that models the
problem of compiling a target single-qubit unitary using a fixed, discrete
gate set. The agent incrementally applies quantum gates to build a circuit
whose resulting unitary approximates a given target operation in SU(2).</p>
<p>At each step, the agent selects a gate action that left-multiplies the current
circuit unitary. The episode reward is based on the average gate fidelity
between the current unitary and the target unitary, encouraging the agent to
discover short, high-fidelity gate sequences.</p>
<section id="key-properties">
<h3>Key properties<a class="headerlink" href="#key-properties" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Action space</strong>: Discrete set of single-qubit gates (Clifford + rotations).</p></li>
<li><p><strong>Observation space</strong>: Flattened real and imaginary parts of the current
<code class="docutils literal notranslate"><span class="pre">2×2</span></code> unitary (shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>).</p></li>
<li><p><strong>Reward</strong>: Average gate fidelity with respect to the target unitary.</p></li>
<li><p><strong>Termination</strong>: Success when fidelity exceeds <code class="docutils literal notranslate"><span class="pre">reward_tolerance</span></code> or
truncation at <code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p></li>
</ul>
</section>
<section id="id5">
<h3>Rendering<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method visualizes the compilation process by displaying a
heatmap of the magnitude of the difference matrix <code class="docutils literal notranslate"><span class="pre">|U_target</span> <span class="pre">−</span> <span class="pre">U|</span></code> over time,
annotated with the current step, last applied gate, and reward.</p>
</section>
<section id="id6">
<h3>Input Parameters<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>target<span class="classifier">np.ndarray</span></dt><dd><p>Target <code class="docutils literal notranslate"><span class="pre">2×2</span></code> unitary matrix in SU(2) to compile towards.</p>
</dd>
<dt>max_steps<span class="classifier">int</span></dt><dd><p>Maximum number of gate applications per episode.</p>
</dd>
<dt>reward_tolerance<span class="classifier">float</span></dt><dd><p>Fidelity threshold for early termination.</p>
</dd>
<dt>ffmpeg<span class="classifier">bool</span></dt><dd><p>Whether to use FFmpeg when saving animations.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><span class="xref std std-doc">tutorials/compiler</span></dt><dd><p>Step-by-step tutorial on compiling SU(2) unitaries using <code class="docutils literal notranslate"><span class="pre">CompilerV0</span></code>.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.CompilerV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.CompilerV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>Apply a quantum gate action and compute the compilation reward.</p>
<p>This method left-multiplies the current circuit unitary by the unitary
corresponding to the selected action and evaluates the average gate
fidelity with respect to the target unitary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average gate fidelity between the current unitary and the target
unitary, defined as
<code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">|Tr(U_target†</span> <span class="pre">·</span> <span class="pre">U)|</span></code> for a single-qubit system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.CompilerV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.CompilerV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the compilation process as an animation of the difference matrix.</p>
<p>The visualization shows the magnitude of the element-wise difference
<code class="docutils literal notranslate"><span class="pre">|U_target</span> <span class="pre">-</span> <span class="pre">U|</span></code> as a heatmap that evolves over time, along with
annotations indicating the current step, applied action, and reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p></li>
<li><p><strong>interval</strong> (<em>int</em><em>, </em><em>optional</em>) – Delay between animation frames in milliseconds. Default is 800.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.CompilerV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.CompilerV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to the initial compilation state.</p>
<p>The circuit unitary is reset to the identity matrix, the step counter
is cleared, and the history buffer is reinitialized.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Flattened observation corresponding to the identity unitary,
shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with the Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.CompilerV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/compiler.html#CompilerV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.CompilerV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one compilation step.</p>
<p>Applies the selected gate, updates the internal circuit unitary and
history, computes the reward, and checks termination conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected action in <code class="docutils literal notranslate"><span class="pre">self.actions</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Updated flattened unitary observation, shape <code class="docutils literal notranslate"><span class="pre">(8,)</span></code>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Average gate fidelity after applying the action.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode has terminated due to reaching the fidelity
threshold or the maximum number of steps.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with the Gymnasium API.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.ErrorChannelV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.</span></span><span class="sig-name descname"><span class="pre">ErrorChannelV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faulty_qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffmpeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/error_channel.html#ErrorChannelV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ErrorChannelV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Multi-qubit error mitigation environment with bit-flip noise.</p>
<p><code class="docutils literal notranslate"><span class="pre">ErrorChannelV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment that models a
noisy multi-qubit quantum system affected by independent bit-flip error channels.
Each qubit may experience noise with a different probability, and the agent’s
task is to apply corrective Pauli-X operations to recover the target computational
basis state <code class="docutils literal notranslate"><span class="pre">|0…0⟩</span></code>.</p>
<p>The environment captures a simplified quantum error mitigation scenario, where
the agent sequentially selects qubits on which to apply corrections based on
observed measurement probabilities.</p>
<section id="id7">
<h3>Key properties<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Action space</strong>: Discrete choice of qubit index on which to apply an <code class="docutils literal notranslate"><span class="pre">X</span></code> gate.</p></li>
<li><p><strong>Observation space</strong>: Probability distribution over all computational basis</p></li>
</ul>
<p>states (shape <code class="docutils literal notranslate"><span class="pre">(2**n_qubits,)</span></code>).
- <strong>Reward</strong>: Negative mean-squared error between the corrected distribution and
the ideal <code class="docutils literal notranslate"><span class="pre">|0…0⟩</span></code> distribution.
- <strong>Termination</strong>: Success when perfect correction is achieved or truncation at
<code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p>
</section>
<section id="id8">
<h3>Rendering<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method visualizes the mitigation process using a side-by-side
animation that compares ideal, noisy, and corrected probability distributions,
along with a dynamically updated circuit diagram showing applied corrections.</p>
</section>
<section id="id9">
<h3>Input Parameters<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>n_qubits<span class="classifier">int</span></dt><dd><p>Number of qubits in the system.</p>
</dd>
<dt>faulty_qubits<span class="classifier">dict[int, float] or None</span></dt><dd><p>Mapping from qubit indices to bit-flip probabilities.</p>
</dd>
<dt>max_steps<span class="classifier">int</span></dt><dd><p>Maximum number of correction steps per episode.</p>
</dd>
<dt>seed<span class="classifier">int or None</span></dt><dd><p>Random seed for reproducibility.</p>
</dd>
<dt>ffmpeg<span class="classifier">bool</span></dt><dd><p>Whether to use FFmpeg to save animations as ,p4 or save it as GIFs with Pillow.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><span class="xref std std-doc">tutorials/error_channel</span></dt><dd><p>Tutorial on multi-qubit error mitigation with bit-flip noise.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ErrorChannelV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/error_channel.html#ErrorChannelV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ErrorChannelV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>Apply a correction action and compute the reward.</p>
<p>The selected qubit index is appended to the correction list, the noisy
and corrected circuits are evaluated, and the reward is computed as the
negative mean-squared error between the corrected and target probability
distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the qubit on which a Pauli-X correction is applied.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reward value defined as the negative mean-squared error between
the corrected probability distribution and the target distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ErrorChannelV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/error_channel.html#ErrorChannelV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ErrorChannelV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the error-mitigation process as an animated visualization.</p>
<p>The animation consists of:
- A bar chart comparing ideal, noisy, and corrected probability
distributions for each computational basis state.
- A dynamically updated ASCII-style circuit diagram showing the
applied correction operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p></li>
<li><p><strong>interval_ms</strong> (<em>int</em><em>, </em><em>optional</em>) – Time between animation frames in milliseconds. Default is 600.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ErrorChannelV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/error_channel.html#ErrorChannelV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ErrorChannelV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to the initial noisy state.</p>
<p>Clears the correction history, resets the step counter, and evaluates
the noisy circuit without any corrective operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Random seed for reproducibility. If provided, reinitializes the
internal random number generator.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>observation</strong> – Initial corrected probability distribution over computational
basis states (identical to the noisy distribution at reset),
with dtype <code class="docutils literal notranslate"><span class="pre">float32</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ErrorChannelV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/error_channel.html#ErrorChannelV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ErrorChannelV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one environment step.</p>
<p>Applies a correction action, updates internal state and history,
computes the reward, and checks termination conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the qubit on which a Pauli-X correction is applied.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Corrected probability distribution over computational basis states,
with dtype <code class="docutils literal notranslate"><span class="pre">float32</span></code>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Negative mean-squared error between the corrected and target
distributions.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode has terminated due to reaching the maximum
number of steps or achieving perfect correction.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Dictionary containing metadata about the environment, including
the mapping of faulty qubits.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.</span></span><span class="sig-name descname"><span class="pre">ExpressibilityV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pairs_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_2q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminate_bonus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default.qubit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_all_to_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffmpeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Parameterized circuit expressibility optimization environment.</p>
<p><code class="docutils literal notranslate"><span class="pre">ExpressibilityV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment that models
the construction of parameterized quantum circuits with high expressibility.
In the context of variational quantum algorithms, expressibility measures how
well an ansatz can explore the Hilbert space of quantum states relative to the
Haar-random distribution.</p>
<p>The agent incrementally builds a circuit by adding or removing predefined
rotation and entangling blocks, or by explicitly terminating construction.
Rewards encourage circuits whose fidelity distribution closely matches the
Haar distribution, while penalizing excessive circuit depth and two-qubit gate
usage.</p>
<section id="id10">
<h3>Key properties<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Action space</strong>: Discrete set of architectural edits (add/remove blocks or</p></li>
</ul>
<p>terminate construction).
- <strong>Observation space</strong>: Vector of circuit statistics summarizing depth,
parameter count, entanglement, and recent expressibility estimates
(shape <code class="docutils literal notranslate"><span class="pre">(7,)</span></code>).
- <strong>Reward</strong>: Negative KL divergence to the Haar distribution with regularization
penalties for depth and two-qubit gates.
- <strong>Termination</strong>: Explicit termination by the agent or truncation at
<code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p>
</section>
<section id="id11">
<h3>Rendering<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method visualizes expressibility optimization via a two-panel
animation showing the circuit’s fidelity distribution compared to the
Haar-random distribution alongside a block-level diagram of the evolving
circuit architecture.</p>
</section>
<section id="id12">
<h3>Input Parameters<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>n_qubits<span class="classifier">int</span></dt><dd><p>Number of qubits in the circuit.</p>
</dd>
<dt>max_blocks<span class="classifier">int</span></dt><dd><p>Maximum number of blocks allowed in the circuit.</p>
</dd>
<dt>max_steps<span class="classifier">int</span></dt><dd><p>Maximum number of construction steps per episode.</p>
</dd>
<dt>n_pairs_eval<span class="classifier">int</span></dt><dd><p>Number of random state pairs used to estimate expressibility.</p>
</dd>
<dt>bins<span class="classifier">int</span></dt><dd><p>Number of histogram bins for fidelity distributions.</p>
</dd>
<dt>lambda_depth<span class="classifier">float</span></dt><dd><p>Penalty weight for circuit depth.</p>
</dd>
<dt>lambda_2q<span class="classifier">float</span></dt><dd><p>Penalty weight for two-qubit gate usage.</p>
</dd>
<dt>terminate_bonus<span class="classifier">float</span></dt><dd><p>Bonus reward for explicit termination.</p>
</dd>
<dt>device_name<span class="classifier">str</span></dt><dd><p>PennyLane device backend used for simulation.</p>
</dd>
<dt>seed<span class="classifier">int or None</span></dt><dd><p>Random seed for reproducibility.</p>
</dd>
<dt>allow_all_to_all<span class="classifier">bool</span></dt><dd><p>Whether to allow all-to-all entangling blocks.</p>
</dd>
<dt>ffmpeg<span class="classifier">bool</span></dt><dd><p>Whether to use FFmpeg when saving animations.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><span class="xref std std-doc">tutorials/expressibility</span></dt><dd><p>Tutorial on optimizing ansatz expressibility with block-based circuits.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0.action_meanings">
<span class="sig-name descname"><span class="pre">action_meanings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0.action_meanings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0.action_meanings" title="Link to this definition"></a></dt>
<dd><p>Return a mapping from action indices to action names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping integer action indices to human-readable
architectural action names.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>The selected action modifies the circuit architecture by adding,
removing, or terminating block construction. Expressibility is
evaluated after the update, and a reward is computed based on the
circuit’s deviation from the Haar distribution and architectural
penalties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected architectural action.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reward</strong> – Reward value combining expressibility and architectural penalties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the expressibility optimization process as an animation.</p>
<p>The animation shows:
1. A histogram of circuit fidelity distribution compared to the
Haar-random distribution.
2. A block-diagram visualization of the evolving circuit architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p></li>
<li><p><strong>interval</strong> (<em>int</em><em>, </em><em>optional</em>) – Delay between animation frames in milliseconds. Default is 800.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to an empty circuit.</p>
<p>Clears the current circuit architecture, resets internal counters, and
initializes the observation vector corresponding to an empty ansatz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Random seed for reproducibility. If provided, reinitializes the
internal random number generator.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Additional reset options (currently unused, included for
Gymnasium compatibility).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Initial observation vector describing an empty circuit, shape <code class="docutils literal notranslate"><span class="pre">(7,)</span></code>.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for Gymnasium API compatibility.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ExpressibilityV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/expressibility.html#ExpressibilityV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ExpressibilityV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one architecture-modification step by calling the get_reward method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>int</em>) – Index of the selected architectural action.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Updated observation vector summarizing circuit statistics,
shape <code class="docutils literal notranslate"><span class="pre">(7,)</span></code>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Reward value combining expressibility and architectural penalties.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode ended due to termination by agent or truncation,
False otherwise.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Diagnostic information including expressibility, KL divergence,
depth, parameter count, current block sequence, and
terminated (true if agent explicitly terminated, false if episode ended due to max steps).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qrl.env.core.ProbabilityV0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qrl.env.core.</span></span><span class="sig-name descname"><span class="pre">ProbabilityV0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ansatz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/probability.html#ProbabilityV0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ProbabilityV0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../qrl.env.core.html#qrl.env.core.base__.QuantumEnv" title="qrl.env.core.base__.QuantumEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumEnv</span></code></a></p>
<p>Probability distribution matching environment for variational quantum circuits.</p>
<p><code class="docutils literal notranslate"><span class="pre">ProbabilityV0</span></code> is a <code class="docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>-compatible environment that trains a
parameterized quantum circuit to approximate a target probability distribution
over computational basis states. The agent optimizes continuous circuit
parameters so that the measurement statistics of the circuit match a specified
target distribution.</p>
<p>This environment is suitable for distribution learning, quantum generative
modeling, and variational circuit optimization tasks.</p>
<section id="id13">
<h3>Key properties<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Action space</strong>: Continuous parameter updates applied to the circuit ansatz.</p></li>
<li><p><strong>Observation space</strong>: Probability distribution over <code class="docutils literal notranslate"><span class="pre">2**n_qubits</span></code> basis</p></li>
</ul>
<p>states produced by the current circuit.
- <strong>Reward</strong>: Negative weighted cost combining KL divergence and L2 distance to
the target distribution, with an additional step penalty.
- <strong>Termination</strong>: Success when the reward exceeds the specified tolerance or
truncation at <code class="docutils literal notranslate"><span class="pre">max_steps</span></code>.</p>
</section>
<section id="visualization">
<h3>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">render()</span></code> method animates the evolution of the learned probability
distribution relative to the target distribution, along with the reward
trajectory over training steps.</p>
</section>
<section id="id14">
<h3>Input Parameters<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>n_qubits<span class="classifier">int</span></dt><dd><p>Number of qubits in the circuit.</p>
</dd>
<dt>target_distribution<span class="classifier">np.ndarray</span></dt><dd><p>Target probability distribution over computational basis states.</p>
</dd>
<dt>ansatz<span class="classifier">callable or None</span></dt><dd><p>Custom parameterized circuit ansatz. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a default RY-based ansatz
is used.</p>
</dd>
<dt>max_steps<span class="classifier">int</span></dt><dd><p>Maximum number of optimization steps per episode.</p>
</dd>
<dt>tolerance<span class="classifier">float</span></dt><dd><p>Reward threshold for early termination.</p>
</dd>
<dt>alpha<span class="classifier">float</span></dt><dd><p>Weight balancing KL divergence and L2 distance.</p>
</dd>
<dt>beta<span class="classifier">float</span></dt><dd><p>Penalty weight for step count.</p>
</dd>
<dt>ffmpeg<span class="classifier">bool</span></dt><dd><p>Whether to use FFmpeg when saving animations.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><span class="xref std std-doc">tutorials/probability</span></dt><dd><p>Tutorial on probability distribution learning with variational circuits.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ProbabilityV0.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/probability.html#ProbabilityV0.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ProbabilityV0.get_reward" title="Link to this definition"></a></dt>
<dd><p>Compute the reward for a given set of circuit parameters.</p>
<p>The reward is based on a weighted combination of:
- Kullback–Leibler (KL) divergence between the target distribution and
the circuit output distribution.
- L2 distance between the target and circuit distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>np.ndarray</em>) – Vector of variational circuit parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar reward value encouraging the circuit output distribution
to match the target distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ProbabilityV0.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path_without_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/probability.html#ProbabilityV0.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ProbabilityV0.render" title="Link to this definition"></a></dt>
<dd><p>Render the evolution of the probability distribution over training steps.</p>
<p>The animation shows a bar plot comparing the target probability
distribution with the circuit’s predicted distribution at each step.
Reward values are displayed in the plot title.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_path_without_extension</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Path (without file extension) to save the animation.
If provided, the animation is saved using the configured writer
(MP4 for FFmpeg or GIF for Pillow). If None, the animation is
displayed interactively.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method produces a visualization but does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ProbabilityV0.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/probability.html#ProbabilityV0.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ProbabilityV0.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the environment to a random initial parameter configuration.</p>
<p>Initializes the circuit parameters randomly, clears episode history,
and resets the step counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Initial circuit parameter vector.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with Gymnasium-style APIs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qrl.env.core.ProbabilityV0.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qrl/env/core/probability.html#ProbabilityV0.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qrl.env.core.ProbabilityV0.step" title="Link to this definition"></a></dt>
<dd><p>Execute one optimization step.</p>
<p>Updates the circuit parameters using the provided action, evaluates
the resulting probability distribution, computes the reward, and
checks termination conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>np.ndarray</em>) – Parameter update vector applied additively to the current
circuit parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>observation</strong> (<em>np.ndarray</em>) – Probability distribution over computational basis states produced
by the circuit after the parameter update.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – Reward value after applying the action.</p></li>
<li><p><strong>done</strong> (<em>bool</em>) – True if the episode has terminated due to reaching the reward
tolerance or the maximum number of steps.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Empty dictionary provided for compatibility with Gymnasium-style APIs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jay Shah.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>